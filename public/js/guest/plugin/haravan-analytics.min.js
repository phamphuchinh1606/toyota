!function(){"use strict";var s={pageType:"",products:[],properties:{arrProductId:"",id:"",variantId:"",name:"",variant:"",category:"",quantity:1,price:0,sku:"",vendor:"",type:"",keySearch:"",coupon:"",orderId:"",shipping:0,subtotal_price:0,total_price:0,cartToken:!1,event:"Action not defined",currency:HaravanAnalytics.meta.currency},options_GA:{anonymizeIp:!1,doubleClick:!0,enhancedEcommerceLoaded:!1,enhancedEcommerce:HaravanAnalytics.enhancedEcommerce||!1,enhancedLinkAttribution:!1,includeSearch:!0,nonInteraction:!1}};function u(e){for(var t=e+"=",r=document.cookie.split(";"),a=0;a<r.length;a++){for(var n=r[a];" "==n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return null}function d(e,t,r){var a,n,i,c,o=new Date,p=e?31536e6:252e5;a=t,n=r,i=o.getTime()+p,c=new Date(i),document.cookie=a+"="+escape(n)+";path=/;expires="+c.toUTCString()}HaravanAnalytics.init=function(){this.registerOnload(function(e){try{HaravanAnalytics.ga&&HaravanAnalytics.ga_eventOnload(e),HaravanAnalytics.fb&&HaravanAnalytics.fb_eventOnload(e)}catch(e){}}),this.registerFormSubmit(function(e){try{HaravanAnalytics.ga&&HaravanAnalytics.ga_eventFormSubmit(e),HaravanAnalytics.fb&&HaravanAnalytics.fb_eventFormSubmit(e)}catch(e){}}),document.addEventListener("DOMContentLoaded",function(e){HaravanAnalytics.registerAjax(function(e){try{HaravanAnalytics.ga&&HaravanAnalytics.ga_eventAjax(e),HaravanAnalytics.fb&&HaravanAnalytics.fb_eventAjax(e)}catch(e){}})})},HaravanAnalytics.registerOnload=function(e){var t=HaravanAnalytics.meta.page.pageType;if(t){if("product"==(s.pageType=t)){var r=HaravanAnalytics.meta.product;r&&(s.properties.id=r.id,r.selected_or_first_available_variant?(s.properties.name=r.selected_or_first_available_variant.title,s.properties.variantId=r.selected_or_first_available_variant.id,s.properties.variant=r.selected_or_first_available_variant.variant_title,s.properties.price=r.selected_or_first_available_variant.price/100,s.properties.sku=r.selected_or_first_available_variant.sku):(s.properties.title=r.title,s.properties.price=r.price/100),s.properties.vendor=r.vendor,s.properties.type=r.type,s.properties.event="Viewed Product")}else if("searchresults"==t){var a=HaravanAnalytics.meta.search;a&&(s.properties.keySearch=a.query)}else if("thankyou"==t){if(!Haravan.checkout)return;var n=Haravan.checkout,i=[],c=0;$.each(n.line_items,function(e,t){var r={id:t.product_id,variantId:t.variant_id,name:t.title,variant:t.variant_title,category:"",quantity:t.quantity,price:t.price,sku:t.sku,vendor:t.vendor,type:"",currency:HaravanAnalytics.meta.currency};s.products.push(r),0==i.includes(t.product_id)&&i.push(t.product_id),c+=t.quantity}),s.properties.arrProductId=i,s.properties.coupon=n.discount.code,s.properties.orderId=n.order_number,s.properties.shipping=n.shipping_rate.price,s.properties.subtotal_price=n.subtotal_price,s.properties.total_price=n.total_price,s.properties.quantity=c,s.properties.event="Completed Order",u("tracked_start_checkout")==n.token?d(!0,"tracked_start_checkout",""):s.properties.cartToken=!0}else if("checkout"==t){var o=HaravanAnalytics.meta.cart,p=HaravanAnalytics.meta.page;if(o&&p){i=[];$.each(o.products,function(e,t){var r={id:t.productId,variantId:t.variantId,name:t.name,variant:t.variant,category:"",quantity:t.quantity,price:t.price,sku:t.sku,vendor:t.vendor,type:t.type,currency:HaravanAnalytics.meta.currency};s.products.push(r),0==i.includes(t.productId)&&i.push(t.productId)}),s.properties.arrProductId=i,s.properties.quantity=o.item_count,s.properties.total_price=o.total_price/100,s.properties.event="Viewed Checkout",u("tracked_start_checkout")!=p.resourceId||""==u("tracked_start_checkout")||null==u("tracked_start_checkout")||"undefined"==u("tracked_start_checkout")?d(!0,"tracked_start_checkout",p.resourceId):s.properties.cartToken=!0}}e(s)}},HaravanAnalytics.registerFormSubmit=function(r){var a={};function n(e,t,r){e.addEventListener?e.addEventListener(t,r):e.attachEvent&&e.attachEvent("on"+t,r)}function i(e){var t=(e=e||window.event).target||e.srcElement;t&&(t.getAttribute("action")||t.getAttribute("href"))&&r(a)}n(window,"load",function(){for(var e=0;e<document.forms.length;e++){var t=document.forms[e].getAttribute("action");t&&0<=t.indexOf("/cart")&&n(document.forms[e],"submit",i)}for(e=0;e<document.links.length;e++){var r=document.links[e].getAttribute("href");r&&0<=r.indexOf("/checkout")&&n(document.links[e],"click",i)}})},HaravanAnalytics.registerAjax=function(o){window.jQuery&&$(document).ajaxSuccess(function(e,t,r){if(null!=r&&-1!=r.url.indexOf("/cart/add")&&null!=t&&t.responseJSON){var a=t.responseJSON,n="",i=function(e){for(var t=e.split("&"),r=0;r<t.length;r++){var a=t[r].split("=");if("quantity"===a[0])return parseInt(a[1])}return 1}(r.data);$.each(a.variant_options,function(e,t){n=n+t+" / "}),s.pageType="ajaxCart";var c=s.properties;c.id=a.product_id,c.variantId=a.variant_id,c.name=a.title+" - "+n.slice(0,-3),c.variant=n.slice(0,-3),c.category="",c.quantity=i,c.price=a.price/100,c.sku=a.sku,c.vendor=a.vendor,c.type="",c.event="Added Product",o(s),s.options_GA.enhancedEcommerce&&HaravanAnalytics.enhancedEcommerce(s)}})},HaravanAnalytics.ga_eventOnload=function(e){var t,r;e&&e.options_GA.enhancedEcommerce&&(e.options_GA.doubleClick&&window.ga("require","displayfeatures"),HaravanAnalytics.ga_pageView(e,(t=window.location.href,t="?"===(t=-1===(r=(t=-1===(r=t.indexOf("?"))?"":t.slice(r)).indexOf("#"))?t:t.slice(0,r))?"":t,{path:window.location.pathname,referrer:document.referrer,search:t,title:document.title,url:function(){var e=function(){for(var e=document.getElementsByTagName("link"),t=0;t<e.length;t++){var r=e[t];if("canonical"===r.getAttribute("rel"))return r.getAttribute("href")}return""}();if(e)return 0<e.indexOf("?")?e:e+window.location.search;var t=window.location.href,r=t.indexOf("#");return-1===r?t:t.slice(0,r)}(),properties:{}})),e.options_GA.enhancedLinkAttribution&&window.ga("require","linkid"),e.options_GA.anonymizeIp&&window.ga("set","anonymizeIp",e.options_GA.anonymizeIp),e.options_GA.enhancedEcommerce&&HaravanAnalytics.enhancedEcommerce(e))},HaravanAnalytics.ga_eventFormSubmit=function(e){e&&ga(function(e){var t=e.get("linkerParam");document.cookie="_haravan_ga="+t+"; path=/"})},HaravanAnalytics.ga_eventAjax=function(e){},HaravanAnalytics.ga_pageView=function(e,t){var r=t.path,a=e.options_GA.includeSearch&&t.search&&(r+=t.search)||r,n=t.title,i={page:a,title:n};window.ga("set",i);var c={page:a,title:n,location:t.url};window.ga("send","pageview",c)},HaravanAnalytics.enhancedEcommerce=function(e){function c(e){var t=e.options_GA;t.enhancedEcommerceLoaded||(window.ga("require","ec"),t.enhancedEcommerceLoaded=!0),window.ga("set","&cu",e.properties.currency)}function t(e){var t=e.properties,r={eventAction:t.event,eventCategory:t.category||"All",eventLabel:t.label,eventValue:t.total_price.toString(),nonInteraction:!0};window.ga("send","event",r)}function o(e){var t={id:e.sku||e.variantId.toString()||e.id.toString(),name:e.name,category:"",quantity:e.quantity,price:e.price.toString(),vendor:e.vendor,variant:e.variant,currency:e.currency};e.coupon&&(t.coupon=e.coupon),window.ga("ec:addProduct",t)}function p(e){var t=e.properties;window.ga("send","event",{eventCategory:t.category||"EnhancedEcommerce",eventAction:t.event,eventLabel:t.label,nonInteraction:!0})}function r(e,t){o(e),window.ga("ec:setAction",t)}var a,n,i,s;"product"==e.pageType?(s=(i=e).properties,c(i),r(s,"detail"),p(i)):"ajaxCart"==e.pageType?(n=(a=e).properties,c(a),r(n,"add"),p(a)):"checkout"==e.pageType?e.properties.cartToken?t(e):function(e){var t=e.products;c(e);for(var r=0;r<e.products.length;r++)o(t[r]);window.ga("ec:setAction","checkout",{step:1}),p(e)}(e):"thankyou"==e.pageType&&(e.properties.cartToken?t(e):function(e){var t=e.properties,r=t.total_price.toString()||t.subtotal_price.toString()||"",a=t.orderId.toString(),n=e.products||[];if(a){c(e);for(var i=0;i<n.length;i++)o(n[i]);window.ga("ec:setAction","purchase",{id:a,affiliation:void 0,revenue:r,tax:"",shipping:t.shipping.toString(),coupon:t.coupon}),p(e)}}(e))},HaravanAnalytics.fb_eventOnload=function(e){e&&("product"==e.pageType?fbq("track","ViewContent",{content_ids:[e.properties.id],content_name:e.properties.name,content_type:"product",value:e.properties.price,currency:e.properties.currency}):"searchresults"==e.pageType?fbq("track","Search",{search_string:e.properties.keySearch}):"thankyou"==e.pageType?(fbq("track","AddPaymentInfo",{value:e.properties.total_price,currency:e.properties.currency}),fbq("track","Purchase",{content_ids:e.properties.arrProductId,content_type:"product",value:e.properties.subtotal_price,num_items:e.properties.quantity,currency:e.properties.currency})):"checkout"!=e.pageType||e.properties.cartToken||fbq("track","InitiateCheckout",{content_ids:e.properties.arrProductId,content_type:"product",value:e.properties.total_price,num_items:e.properties.quantity,currency:e.properties.currency}))},HaravanAnalytics.fb_eventFormSubmit=function(e){},HaravanAnalytics.fb_eventAjax=function(e){e&&fbq("track","AddToCart",{content_ids:[e.properties.id],content_name:e.properties.name,content_type:"product",value:e.properties.price,num_items:e.properties.quantity,currency:e.properties.currency})};try{HaravanAnalytics.init()}catch(e){}}();